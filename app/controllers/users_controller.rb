class UsersController < ApplicationController
  # new, createã‚¢ã‚¯ã‚·ãƒ§ãƒ³(æ–°è¦ä½œæˆ)ã®å‰ã«require_loginã‚’è¡Œã‚ãªã„
  skip_before_action :require_login, only: [:new, :create]

  # pagyã‚’å°Žå…¥
  include Pagy::Backend

  # ransackã‚’ä½¿ã£ã¦æ¤œç´¢ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’@qã«å…¥ã‚Œã¦ã„ã‚‹
  # ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ãƒšãƒ¼ã‚¸
  def index
    @q = User.ransack(params[:q])
  end

  # æ–°è¦ä½œæˆã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼
  def new
    @user = User.new
  end

  # æ–°è¦ä½œæˆã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
  def create
    @user = User.new(user_params)
    @user.nickname = array.sample
    if @user.save
      auto_login(@user)
      redirect_to new_user_diary_path(@user)
    else
      render :new
    end
  end

  # é€€ä¼š
  def destroy
    @user = User.find(params[:id])
    @user.destroy
    redirect_to root_path, success: 'thank you'
  end

  # ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã„ã‚‹äººå…¨å“¡
  def following
    @user = User.find(params[:user_id])
    # @users = @user.followings

    @pagy, @users = pagy(@user.followings)
  end

  # ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼å…¨å“¡
  def follower
    @user = User.find(params[:user_id])
    # @users = @user.followers
    @pagy, @users = pagy(@user.followers)
  end

  # ransackã‚’ä½¿ã£ã¦æ¤œç´¢ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’@qã«å…¥ã‚Œã¦ã„ã‚‹
  # ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã®çµæžœ
  def search
    @q = User.search(search_params)
    # @users = @q.result(distinct: true)

    @pagy, @users = pagy(@q.result(distinct: true))
  end

  private

  # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã§é€ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚«ãƒ©ãƒ ã®æƒ…å ±
  def user_params
    params.require(:user).permit(:nickname, :name, :password, :password_confirmation, :email)
  end

  # ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã§å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚«ãƒ©ãƒ ã®æƒ…å ±
  def search_params
    params.require(:q).permit(:name_cont)
  end

  def array
    ['ðŸ§žâ€â™€ï¸', 'ðŸ§ž', 'ðŸ§žâ€â™‚ï¸', 'ðŸ§œâ€â™€ï¸', 'ðŸ§šâ€â™€ï¸', 'ðŸ’ƒ', 'ðŸ•º', 'ðŸ§¶', 'ðŸ§µ', 'ðŸª¡', 'ðŸ‘‘', 'ðŸ‘›', 'ðŸ‘’', 'ðŸ¶', 'ðŸ±', 'ðŸ­', 'ðŸ¹', 'ðŸ°', 'ðŸ¦Š', 'ðŸ»', 'ðŸ¼', 'ðŸ»', 'ðŸ¨', 'ðŸ¯', 'ðŸ¦', 'ðŸ®', 'ðŸ·',
     'ðŸ¸', 'ðŸµ', 'ðŸ’', 'ðŸ”', 'ðŸ§', 'ðŸ¤', 'ðŸ£', 'ðŸ¥', 'ðŸ¦†', 'ðŸ¦…', 'ðŸ¦‰', 'ðŸ¦‡', 'ðŸº', 'ðŸ—', 'ðŸ´', 'ðŸ¦„', 'ðŸ', 'ðŸ¦‹', 'ðŸŒ', 'ðŸ›', 'ðŸž', 'ðŸœ', 'ðŸ¢', 'ðŸ¦–', 'ðŸ¦•', 'ðŸ™', 'ðŸ¦', 'ðŸ¦€',
     'ðŸ¡', 'ðŸ ', 'ðŸŸ', 'ðŸ¬', 'ðŸ³', 'ðŸ‹', 'ðŸ¦ˆ', 'ðŸ¦­', 'ðŸŠ', 'ðŸ…', 'ðŸ†', 'ðŸ¦“', 'ðŸ¦›', 'ðŸ˜', 'ðŸª', 'ðŸ«', 'ðŸ¦’', 'ðŸ¦˜', 'ðŸ„', 'ðŸŽ', 'ðŸ–', 'ðŸ', 'ðŸ¦™', 'ðŸ•', 'ðŸ©', 'ðŸ¦Œ', 'ðŸˆ', 'ðŸˆâ€â¬›',
     'ðŸª¶', 'ðŸ“', 'ðŸ¦ƒ', 'ðŸ¦¤', 'ðŸ¦š', 'ðŸ¦œ', 'ðŸ¦¢', 'ðŸ¦©', 'ðŸ•Š', 'ðŸ‡', 'ðŸ¦', 'ðŸ¦¨', 'ðŸ¦¡', 'ðŸ¦«', 'ðŸ¦¦', 'ðŸ¦¥', 'ðŸ', 'ðŸ€', 'ðŸ¿', 'ðŸ¦”', 'ðŸ¾', 'ðŸ‰', 'ðŸŒµ', 'ðŸŽ„', 'ðŸªµ', 'ðŸŒ´', 'ðŸŒ±', 'ðŸŒ¿',
     'â˜˜ï¸', 'ðŸ€', 'ðŸª´', 'ðŸƒ', 'ðŸ‚', 'ðŸ', 'ðŸ„', 'ðŸš', 'ðŸŒ¾', 'ðŸ’', 'ðŸŒ·', 'ðŸŒ¹', 'ðŸŒº', 'ðŸŒ¸', 'ðŸŒ¼', 'ðŸŒ»', 'ðŸŒ™', 'ðŸŒ', 'ðŸª', 'â­ï¸', 'ðŸ”¥', 'ðŸŒˆ', 'â›„ï¸', 'ðŸ', 'ðŸŽ', 'ðŸ', 'ðŸŠ', 'ðŸ‹', 'ðŸŒ',
     'ðŸ‰', 'ðŸ‡', 'ðŸ“', 'ðŸˆ', 'ðŸ’', 'ðŸ‘', 'ðŸ¥­', 'ðŸ', 'ðŸ¥¥', 'ðŸ¥', 'ðŸ…', 'ðŸ†', 'ðŸ¥‘', 'ðŸ¥¦', 'ðŸ¥¬', 'ðŸ¥’', 'ðŸŒ¶', 'ðŸ«‘', 'ðŸŒ½', 'ðŸ¥•', 'ðŸ§…', 'ðŸ ', 'ðŸ¥', 'ðŸ¥¯', 'ðŸž', 'ðŸ¥–', 'ðŸ¥¨', 'ðŸ§€', 'ðŸ³',
     'ðŸ¥ž', 'ðŸ§‡', 'ðŸ¥“', 'ðŸ¥©', 'ðŸ—', 'ðŸ–', 'ðŸ¦´', 'ðŸŒ­', 'ðŸ”', 'ðŸŸ', 'ðŸ•', 'ðŸ¥ª', 'ðŸ¥™', 'ðŸŒ®', 'ðŸŒ¯', 'ðŸ¥—', 'ðŸ¥˜', 'ðŸ¥«', 'ðŸ', 'ðŸœ', 'ðŸ›', 'ðŸ£', 'ðŸ¥Ÿ', 'ðŸ¦ª', 'ðŸ¤', 'ðŸ™', 'ðŸ˜', 'ðŸ¥', 'ðŸ¢',
     'ðŸ¡', 'ðŸ§', 'ðŸ¨', 'ðŸ¦', 'ðŸ¥§', 'ðŸ§', 'ðŸ°', 'ðŸŽ‚', 'ðŸ®', 'ðŸ­', 'ðŸ¬', 'ðŸ«', 'ðŸ¿', 'ðŸ©', 'ðŸª', 'ðŸŒ°', 'ðŸ¥œ', 'ðŸ¯', 'ðŸ¼', 'ðŸ«–', 'â˜•ï¸', 'ðŸµ', 'ðŸ§ƒ', 'ðŸ¥¤', 'ðŸ§‹', 'ðŸ¶', 'ðŸº', 'ðŸ¥‚', 'ðŸ·',
     'ðŸ¹', 'ðŸ¾', 'âš½ï¸', 'ðŸ€', 'ðŸˆ', 'ðŸŽ¾', 'ðŸ', 'ðŸŽ±', 'ðŸ“', 'ðŸ¸', 'ðŸ’', 'ðŸ¥', 'â›³ï¸', 'ðŸª', 'ðŸ¹', 'ðŸŽ£', 'ðŸ¥Š', 'ðŸ¥‹', 'ðŸ›¹', 'ðŸ›¼', 'ðŸ›·', 'â›¸', 'â›·', 'ðŸ‚', 'ðŸª‚', 'ðŸ‡', 'ðŸ„â€â™‚ï¸', 'ðŸ†', 'ðŸŽª',
     'ðŸŽ­', 'ðŸ©°', 'ðŸŽ¨', 'ðŸŽ¬', 'ðŸŽ¤', 'ðŸŽ§', 'ðŸŽ¼', 'ðŸŽ¹', 'ðŸ¥', 'ðŸª˜', 'ðŸŽ·', 'ðŸŽº', 'ðŸª—', 'ðŸŽ¸', 'ðŸª•', 'ðŸŽ»', 'ðŸŽ²', 'ðŸŽ¯', 'ðŸŽ³', 'ðŸŽ®', 'ðŸŽ°', 'ðŸ§©', 'ðŸš—', 'ðŸšŒ', 'ðŸŽ', 'ðŸš“', 'ðŸš‘', 'ðŸš’', 'ðŸ›´',
     'ðŸš²', 'ðŸ›µ', 'ðŸ', 'ðŸšƒ', 'ðŸš…', 'ðŸš‚', 'ðŸ›«', 'ðŸ›°', 'ðŸš€', 'ðŸ›¸', 'ðŸš', 'ðŸ›¶', 'â›µï¸', 'ðŸ›¥', 'âš“ï¸', 'ðŸ—º', 'ðŸ—¿', 'ðŸ—½', 'ðŸ—¼', 'ðŸ°', 'ðŸ¯', 'ðŸŸ', 'ðŸŽ¡', 'ðŸŽ¢', 'ðŸŽ ', 'â›²ï¸', 'ðŸ–', 'ðŸ', 'ðŸœ',
     'ðŸŒ‹', 'ðŸ•', 'ðŸ—»', 'ðŸ“·', 'ðŸŽž', 'ðŸ§­', 'â°', 'ðŸ•°', 'â³', 'ðŸ“¡', 'ðŸ”¦', 'ðŸ’¡', 'ðŸª”', 'ðŸ•¯', 'ðŸ’¸', 'ðŸ’Ž', 'ðŸ’£', 'ðŸ§¨', 'ðŸ”®', 'ðŸ”­', 'ðŸ”¬', 'ðŸ§º', 'ðŸ§½', 'ðŸ›Ž', 'ðŸ”‘', 'ðŸ—', 'ðŸª‘', 'ðŸšª', 'ðŸ›‹',
     'ðŸ§¸', 'ðŸª†', 'ðŸ–¼', 'ðŸªž', 'ðŸ›', 'ðŸ›’', 'ðŸŽ', 'ðŸŽˆ', 'ðŸŽ', 'ðŸŽ€', 'ðŸŽ', 'ðŸ“®', 'ðŸ“š', 'ðŸ”–', 'ðŸ§·', 'ðŸƒ']
  end
end
